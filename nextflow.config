// Config variables
params.out         = '/spaces/phelelani/ssc_data/nf-rnaSeqCount'
params.bind        = '/global/;/spaces/'

out_path           = params.out
bind               = params.bind.split(';')
bind_paths         = bind.collect { entry ->  "--bind $entry:$entry" } .join(' ')

// Process options
process {
    cache = true
    executor = 'pbs'
    queue = 'batch'
    stageInMode = 'symlink'
    stageOutMode = 'rsync'
}

// Process containers
process.$runSTAR_process.container = 'containers/phelelani-nf-rnaSeqMetagen-master-star.simg'
process.$runKrakenClassifyReads_process.container = 'containers/phelelani-nf-rnaSeqMetagen-master-kraken.simg'
process.$runKrakenClassifyFasta_process.container = 'containers/phelelani-nf-rnaSeqMetagen-master-kraken.simg'
process.$runTrinityAssemble_process.container = 'containers/phelelani-nf-rnaSeqMetagen-master-trinity.simg'
process.$runKronareport.container = 'containers/phelelani-nf-rnaSeqMetagen-master-kraken.simg'
process.$runMultiQC_process.container = 'containers/phelelani-nf-rnaSeqMetagen-master-multiqc.simg'

// Singularity options
singularity {
    enabled = true
    cacheDir = 'containers'
    runOptions = "${bind_paths} --cleanenv"
    autoMounts = false
}

// Pipeline tracing & visualization
trace {
    enabled = true
    file = "${out_path}/report_workflow/nf-rnaSeqMetagen_trace.txt"
}
timeline {
    enabled = true
    file = "${out_path}/report_workflow/nf-rnaSeqMetagen_timeline.html"
}
report {
    enabled = true
    file = "${out_path}/report_workflow/nf-rnaSeqMetagen_report.html"
}
dag {
    enabled = true
    file = "${out_path}/report_workflow/nf-rnaSeqMetagen.dot"
}
